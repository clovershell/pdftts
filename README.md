# PyQt6 PDF阅读器与语音助手

这是一个基于PyQt6和PyMuPDF的PDF阅读器应用程序，集成了OCR识别和TTS语音朗读功能。

## 功能特性

- 📖 打开PDF文件
- 📄 浏览PDF页面（上一页/下一页）
- 🔍 缩放功能（放大/缩小）
- 🤖 OCR文字识别（基于PaddleOCR）
- 🔊 TTS语音朗读（基于pyttsx3）
- ✨ **朗读时文字高亮显示**（黄色半透明标记）
- 💾 自动保存上次会话（文件位置和页码）
- 🎯 简洁的用户界面
- ⌨️ 完善的键盘快捷键支持

## 安装依赖

在使用此应用程序之前，请确保安装所需的依赖项：

```bash
pip install -r requirements.txt
```

主要依赖包括：
- PyQt6：用于GUI界面
- PyMuPDF (fitz)：PDF文件处理
- PaddleOCR：文字识别
- pyttsx3：文本转语音
- OpenCV (cv2)：图像处理
- Pillow (PIL)：图像处理

## 使用方法

运行主程序：

```bash
python main.py
```

## 操作说明

1. 点击"打开"按钮选择PDF文件
2. 使用"上一页"和"下一页"按钮浏览页面
3. 使用"放大"和"缩小"按钮调整视图大小
4. 点击"识别并朗读"按钮，对当前页面进行OCR识别并**连续朗读整页所有文字**
5. **朗读过程中，当前朗读的文字会被黄色半透明框高亮显示，自动跟随朗读进度**
6. 点击"停止朗读"按钮，随时中断语音播放
7. 点击"清除高亮"按钮，手动清除页面上的高亮标记
5
## 键盘快捷键

| 功能 | 快捷键 |
|------|--------|
| 打开文件 | Ctrl+O |
| 下一页 | 右箭头, Page Down |
| 上一页 | 左箭头, Page Up |
| 放大 | Ctrl++ |
| 缩小 | Ctrl+- |
| 识别并朗读 | Ctrl+R, F9 |
| 停止朗读 | Ctrl+T |

## 高亮功能说明

### ✨ 核心特性
- **智能文字定位**：OCR识别时会记录每个文字块的精确位置坐标
- **实时高亮显示**：朗读过程中，当前朗读的文字块会用黄色半透明框标记
- **自动坐标转换**：高亮位置会根据当前缩放级别自动调整，确保标记准确
- **自动清除机制**：朗读完成、停止朗读或切换页面时会自动清除高亮
- **手动清除功能**：提供"清除高亮"按钮支持手动清除标记

### 🔧 技术实现
- OCR使用200 DPI高分辨率处理，提高识别精度
- **智能文字排序**：按从上到下、从左到右的阅读顺序重排文字块
- **连续分段朗读**：逐个文字块朗读，确保完整覆盖整页内容
- **实时高亮跟随**：朗读到哪里，高亮显示到哪里，提供视觉反馈
- 坐标系自动转换，支持任意缩放级别
- 多线程处理，UI响应流畅

## 系统要求

- Python 3.7+
- PyQt6
- PyMuPDF (fitz)
- PaddleOCR
- pyttsx3
- OpenCV
- Pillow

## 特别说明

- 首次运行时，PaddleOCR会自动下载中文识别模型
- 应用程序会自动保存上次打开的文件和页码，下次启动时自动恢复
- OCR识别和TTS朗读在后台线程中运行，不会阻塞主界面
- 高亮显示基于OCR识别的文字框位置，准确度取决于OCR识别质量
- 置信度低于0.5的文字识别结果会被自动过滤